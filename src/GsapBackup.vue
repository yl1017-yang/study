<template>
  <main class="container">
    <section class="content">
      <div>Sustainable 페이지 - GSAP</div>


      <div class="sustainable_wrap">

        <section class="section01">
          <div class="inner">
            <div class="img_bg">
              <img src="https://d3phaj0sisr2ct.cloudfront.net/site/images/tools/aitools-background-01.jpg" alt="">
            </div>
            <div class="text_con1">
              <h1>#Sustainable Lifestyle</h1>
              <p>나와 지구를 위한 바른먹거리 마켓,<br>사람과 자연을 함께 사랑하는 풀무원이 권하는 지혜로운 라이프 스타일</p>
            </div>
            <div class="img_con">
                <video autoplay="" muted="" loop="" playsinline="">
                  <!-- <source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/Header_1.1+1.webm" type="video/webm">
                  <source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/Header_1.1+1.mp4" type="video/mp4"> -->
                  <source src="https://pulmuonevideo.com/230202.mp4" type="video/mp4">
                </video>
            </div>
            <div class="text_con2">
              <h2>사회책임경영</h2>
              <p>‘이웃사랑’과 ‘생명존중’ 정신을 바탕으로 <br>로하스 생활(LOHAS Living)을 구현해 나갑니다.</p>
            </div>
          </div>
        </section>


        <section class="section02">
          <h1>
            스크롤시 교차되는 이미지 
            <a href="#modal_view1" class="btn_open">자세히 보기 1</a>
            <a href="#modal_view2" class="btn_open">자세히 보기 2</a>
          </h1>
          <div class="inner">
            <div class="box1"><img src="https://cdn.pixabay.com/photo/2024/04/16/16/25/ai-generated-8700383_1280.jpg" alt=""></div>
            <div class="box2"><img src="https://cdn.pixabay.com/photo/2023/08/17/05/55/ai-generated-8195533_1280.png" alt=""></div>
            <div class="box3"><img src="https://cdn.pixabay.com/photo/2023/09/17/22/25/witch-8259351_1280.jpg" alt=""></div>
          </div>
        </section>

        <!-- [D] 모달팝업 -->
        <div id="modal_view1" class="modal_wrap">
          <div class="inner">
            <h2>첫번째 모달팝업</h2>
            <p>‘이웃사랑’과 ‘생명존중’ 정신을 바탕으로 <br>로하스 생활(LOHAS Living)을 구현해 나갑니다.</p>
            <button type="button" class="btn_close">닫기</button>
          </div>
        </div>

        <div id="modal_view2" class="modal_wrap">
          <div class="inner">
            <h2>사회책임경영</h2>
            <p>‘이웃사랑’과 ‘생명존중’ 정신을 바탕으로 <br>로하스 생활(LOHAS Living)을 구현해 나갑니다.</p>
            <button type="button" class="btn_close">닫기</button>
          </div>
        </div>


        <section class="section03">
          <h1>스크롤시 가로흐름 이미지</h1>
            <div class="row_img flow1">
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_1.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_1.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_2.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_2.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_3.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_3.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_4.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_4.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_1.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_1.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_2.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_2.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_3.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_3.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_4.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_4.mp4" type="video/mp4"></video>
              </div>
            </div>

            <div class="row_img flow2">
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_5.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_5.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_6.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_6.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_7.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_7.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_8.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_8.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_5.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_5.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_6.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_6.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_7.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_7.mp4" type="video/mp4"></video>
              </div>
              <div class="panel">
                <video  loop="" playsinline="" autoplay="" muted="" poster="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_8.jpg"><source src="https://d3phaj0sisr2ct.cloudfront.net/site/videos/tools/custom-styles/CustomStyle_Video_8.mp4" type="video/mp4"></video>
              </div>
            </div>
            
        </section>

        <section class="section04">
          <h1>마우스 오버시 이미지 확장</h1>
          <div class="inner">
            <ul class="img-hover">
              <li class="on fade1">
                <a>
                  <h2>첫번째 내용</h2>
                  <p>서브내용</p>
                </a>
              </li>
              <li class="fade2">
                <a>
                  <h2>두번째 내용</h2>
                  <p>서브내용</p>
                </a>
              </li>
              <li class="fade3">
                <a>
                  <h2>세번째 내용</h2>
                  <p>서브내용</p>
                </a>
              </li>
            </ul>
          </div>
        </section>

        <section class="section05">
          <h1>마우스 오버시 서브내용 출력</h1>
          <div class="inner">
            <ul class="img-active">
              <li>
                <!-- <div>
                  <h2>첫번째 카드</h2>
                  <p>첫번째 서브내용</p>
                </div> -->
                <a>
                  <h2>첫번째 타이틀</h2>
                  <p>서브내용</p>
                </a>
              </li>
              <li>
                <a>
                  <h2>두번째 타이틀</h2>
                  <p>두번째 서브내용</p>
                </a>
              </li>
              <li>
                <a>
                  <h2>세번째 타이틀</h2>
                  <p>세번째 서브내용</p>
                </a>
              </li>
            </ul>
          </div>
        </section>


      </div>

    </section>
  </main>
</template>

<script>
export default {
  name: 'AppGsap',

  // created() {
  //   const gsapScript = document.createElement('script');
  //   gsapScript.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js";
  //   gsapScript.type = 'text/javascript';
  //   gsapScript.async = true;
  //   gsapScript.onload = () => {
  //     const scrollTriggerScript = document.createElement('script');
  //     scrollTriggerScript.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js";
  //     scrollTriggerScript.type = 'text/javascript';
  //     scrollTriggerScript.async = true;
  //     scrollTriggerScript.onload = () => {
  //       this.runAnimations();
  //     };
  //     document.head.appendChild(scrollTriggerScript);
  //   };
  //   document.head.appendChild(gsapScript);
  // },

  created() {
    // 라우터 사용시 한번만 실행
    this.$router.beforeEach((to, from, next) => {
      if (from.name === this.$route.name && to.name !== this.$route.name) {
        this.removeScripts();
      }
      next();
    });

    // 스크립트 로딩
    const gsapScript = document.createElement('script');
    gsapScript.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js";
    gsapScript.type = 'text/javascript';
    gsapScript.async = true;
    gsapScript.onload = () => {
      const scrollTriggerScript = document.createElement('script');
      scrollTriggerScript.src = "https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js";
      scrollTriggerScript.type = 'text/javascript';
      scrollTriggerScript.async = true;
      scrollTriggerScript.onload = () => {
        this.runAnimations();
      };
      document.head.appendChild(scrollTriggerScript);
    };
    document.head.appendChild(gsapScript);
  },


  methods: {
    runAnimations() {
      const gsap = window.gsap;
      const ScrollTrigger = window.ScrollTrigger;

      gsap.registerPlugin(ScrollTrigger);

      //상단타이틀
      gsap.to(".text_con1", {
        scrollTrigger: {
          trigger: '.section01',
          start: "0% 0%",
          end: "100% 50%",
          scrub: 1,
          markers: false,
        },  
        top: "-100%",
      });

      //상단서브타이틀
      gsap.from(".text_con2", {
        scrollTrigger: {
          trigger: '.section01',
          start: "top top",
          end: "bottom bottom",
          scrub: 1,
          markers: false,
        },  
        top: "30%",
        duration: 1
      });

      //상단 배경
      gsap.fromTo(".img_bg", 
      { opacity: 1, scale: 1 },
      { 
        scrollTrigger: {
          trigger: '.section01',
          start: "0% 0%",
          end: "bottom 60%",
          scrub: 0.5,
          markers: false,
        },
        scale: 1.2,
        opacity: 0,
      });

      //상단 무비
      gsap.fromTo(".section01 .img_con",
        { scale: 0.7 },
        {
          scale: 1,
          ease: "none",
          force3D: true,
          scrollTrigger: {
            pin: ".section01",
            trigger: ".section01",
            start: "0% 0%",
            end: "bottom top",
            scrub: 0.5,
            markers: false,
          },
          y: -100,
          borderRadius: 50,
        }
      );

      //스크롤시 교차되는 이미지
      const boxScroll = gsap.timeline({
        scrollTrigger: {
          trigger: '.section02',
          start: "0% 30%",
          end: "100% 80%",
          scrub: 1,
          markers: false
        }
      });
      boxScroll.to(".box2", {y: 100, duration: 1})
      boxScroll.to(".box3", {y: -100})

      //스크롤시 가로흐름 이미지
      let flow1 = gsap.utils.toArray(".flow1 .panel");
      gsap.to(flow1, {
        xPercent: -100 * (flow1.length - 1),
        ease: "none",
        scrollTrigger: {
          trigger: ".section03",
          // pin: true,
          scrub: 1,
          // snap: 1 / (flow1.length - 1),
          markers: false,
          start: "0% 30%",
          // end: () => "+=" + document.querySelector(".section03").offsetWidth
        }
      });

      let flow2 = gsap.utils.toArray(".flow2 .panel");
      gsap.to(flow2, {
        xPercent: 100 * (flow1.length - 1),
        ease: "none",
        scrollTrigger: {
          trigger: ".section03",
          // pin: true,
          scrub: 1,
          // snap: 1 / (flow1.length - 1),
          markers: false,
          start: "0% 30%",
          // end: () => "+=" + document.querySelector(".section03").offsetWidth
        },
        duration: 1
      });

      //모달팝업
      const modalOpen = document.querySelectorAll(".btn_open");
      const modalClose = document.querySelectorAll(".modal_wrap .btn_close");
      var targetID;

      modalOpen.forEach( number => {
        number.addEventListener('click', function(){
          targetID = this.getAttribute('href');
          document.querySelector(targetID).classList.add('is_active');
        });
      });

      modalClose.forEach( number => {
        number.addEventListener('click', function(){
          this.parentNode.parentNode.classList.remove('is_active');
        });
      });

    },

    removeScripts() {
      // 스크립트 제거 코드
      const scripts = document.querySelectorAll('script[src^="https://cdnjs.cloudflare.com/ajax/libs/gsap"]');
      scripts.forEach(script => {
        script.remove();
      });
    }

  }
};
</script>


<style scoped>
.content{position:relative;max-width:1920px;margin:0 -376px auto;overflow:hidden;}

.sustainable_wrap h1{font-size:60px;font-weight:800;margin-bottom:20px;text-align:center;}
.sustainable_wrap h2{font-size:40px;margin-bottom:5px;}
.sustainable_wrap img{max-width:100%;}

.sustainable_wrap{position:relative;overflow:hidden;font-size:28px;}

.section01 {position: relative; background: #ddd;}  /*aspect-ratio: 1920/1100;  background:#eee url(https://d3phaj0sisr2ct.cloudfront.net/site/images/tools/aitools-background-01.jpg) 100% 100% / cover no-repeat; */
.section01 .inner { position: relative; width: 100%; overflow: hidden;}
.section01 .text_con1 { position: fixed; top:0;left:0;width: 100%;height:100%; text-align: center;color:#fff;}
.section01 .text_con1 > h1 {margin-top:100px;font-weight:800;}
.section01 .img_con { position: relative;  display: flex; flex-direction: column; width: 1400px; aspect-ratio: 1830/880; overflow: hidden; z-index: 0; margin:200px auto 0;} /* aspect-ratio: 2560/1226; */
.section01 .img_con video { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; height: auto; transition: transform 0.2s ease-in-out; }
.section01 .text_con2 {top:0; width:1000px;margin:-50px auto 0;padding-bottom:140px;}
.section01 .img_bg { position: absolute;top:0;left:0;width:100%;height:100%;}
.section01 .img_bg img{width:100%;height:100%;}

.section02 { position: relative; background: #ddd; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; padding:120px 0;}
.section02 .inner{width:1000px;margin:0 auto;display:flex;justify-content: space-between;}
.section02 .inner > div{width: 310px; height: 500px;text-align:center;color:#fff;overflow: hidden;}
.section02 .inner > div > img{width:100%;height:100%;}
.box1 {margin-top: 100px; background: #444; }
.box2 {margin-top: 150px; background: rgb(43, 136, 167); }
.box3 {margin-top: 200px; background: green; }

.section03 { position: relative;background: goldenrod; padding:200px 0;}
.row_img{width: 100%; height: auto; display: flex; flex-wrap: nowrap;}
.row_img .panel{height:320px;margin:.25rem;aspect-ratio: 16 / 9;} /* flex: 1 1; */
.row_img .panel video{max-width:100%;width:100%;height:100%;object-fit:cover;border-radius:.375rem;overflow:hidden;}
.row_img.flow2{flex-direction: row-reverse;}

.section04 { position: relative;background:#ddd; padding:140px 0;overflow:hidden; }
.section04 .inner{width:1000px;margin:0 auto;}

.img-hover {position: relative;width: 1100px; margin: 0 auto; display: flex; justify-content: space-between; overflow: hidden; }
.img-hover li{position: relative;  width: 300px; height:500px; transition: width 0.3s; cursor: pointer;}
.img-hover li::before {content: ""; display: block; width: 100%; height: 100%;  background-position: center;background-size:auto 100%; background-size: cover;}
.img-hover li::after {content: ""; display: block; position: absolute; top: 0; left:0; width: 100%; height: 100%;  background: rgba(0, 0, 0, .5);transition: opacity 0.3s;}
.img-hover li:nth-child(1)::before{background-image: url("https://cdn.pixabay.com/photo/2023/09/25/03/27/ai-generated-8274116_1280.png");}
.img-hover li:nth-child(2)::before{background-image: url("https://cdn.pixabay.com/photo/2024/04/22/17/03/ai-generated-8713076_1280.png");}
.img-hover li:nth-child(3)::before{background-image: url("https://cdn.pixabay.com/photo/2019/04/06/06/44/astronaut-4106766_1280.jpg");}

.img-hover li a{ display: block; position: absolute; bottom:50px;left:40px;color: #fff; transition: font-size 0.3s; z-index:1;}
.img-hover li.on a {}
.img-hover li.on a::before { }
.img-hover li.on { width: 450px; }
.img-hover li.on::after, .img-hover li:hover::after{opacity: 0;}
.img-hover li:hover { width: 450px; }
/* .img-hover li:hover a { font-size: 24px; } */
.img-hover:hover .on { width: 300px; }
/* .img-hover:hover .on a { font-size: 14px; } */
.img-hover:hover .on:hover { width: 450px; }
/* .img-hover:hover .on:hover a { font-size: 24px; } */

.section05 { position: relative;background:green; padding:140px 0;overflow:hidden; }
.section05 .inner{width:1000px;margin:0 auto;}

.img-active {position: relative; width: 1100px; margin: 0 auto; display: flex; justify-content: space-between; overflow: hidden; }
.img-active li {position: relative;  width: 33.3%; height:500px; transition: width 0.3s; cursor: pointer;}
.img-active li::before {content: ""; display: block; width: calc(100% - 10px); height: 100%;  background-position: center;background-size:auto 100%; background-size: cover;}
/* .img-active li::after {content: ""; display: block; position: absolute; top: 0; left:0; width: 100%; height: 100%;  background: rgba(0, 0, 0, .2);transition: opacity 0.3s;} */
.img-active li:nth-child(1)::before{background-image: url("https://cdn.pixabay.com/photo/2023/09/25/03/27/ai-generated-8274116_1280.png");}
.img-active li:nth-child(2)::before{background-image: url("https://cdn.pixabay.com/photo/2024/04/22/17/03/ai-generated-8713076_1280.png");}
.img-active li:nth-child(3)::before{background-image: url("https://cdn.pixabay.com/photo/2019/04/06/06/44/astronaut-4106766_1280.jpg");}

/* .img-active li > div{position: absolute; top:0;left:0;width:100%;height:100%;color: #fff; transition: all 0.2s; z-index:1;overflow:hidden;} */
.img-active li a{display: block; position: absolute; top:0;left:0;width:100%;height:100%;color: #fff; transition: all 0.3s; z-index:1;overflow:hidden;}
.img-active li a:hover {display: block; position: absolute;top:0;left:0; width:1100px; height:100%;background: rgba(0, 0, 0, .9);}
.img-active li:nth-child(2) a:hover{left:-100%}
.img-active li:nth-child(3) a:hover{left:-200%}


.section06 { position: relative;background:aquamarine; padding:140px 0;overflow:hidden; }
.section06 .inner{display:flex;flex-wrap: wrap;width:1000px;margin:0 auto;}

.section06 .img1{width:40%;margin-right:20px;}
.section06 .text1{width:55%}
.section06 .img2{margin-top:120px;}


/* 모달팝업 */
.btn_open{display:inline-flex;font-size:20px;border:1px solid #444;padding:8px 40px;}
.modal_wrap .btn_close{display:block;position:absolute;width:44px;height:44px;right:20px;top:20px;text-indent:-999em;cursor:pointer;}
.modal_wrap .btn_close:before{content:'';display:block;position:absolute;width:24px;height:2px;left:26%;top:47%;background:#222;transform:rotate(-45deg);-webkit-transform:rotate(-45deg);-moz-transform:rotate(-45deg);-o-transform:rotate(-45deg);-ms-transform:rotate(-45deg);}
.modal_wrap .btn_close:after{content:'';display:block;position:absolute;width:24px;height:2px;left:26%;top:47%;background:#222;transform:rotate(45deg);-webkit-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);-ms-transform:rotate(45deg);}

.modal_wrap{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.7);display:flex;align-items:center;justify-content:center;z-index:100;opacity:0;visibility:hidden;transition:all 0.2s ease-in-out;}
.modal_wrap.is_active{opacity:1;visibility:visible;}
.modal_wrap .inner{position:relative;background:#fff;width:900px;padding:70px 50px;}
</style>
